# crules - プロジェクトルール管理 CLI ツール

## 1. プロジェクト概要

### 1.1 目的

- プロジェクトごとに異なるルールとノートを効率的に管理・配置する
- 編集可能な形式でルールとノートを維持する
- 簡単なインストールと使用方法を提供する

### 1.2 主要機能

#### ルールとノートの管理

- プロジェクトごとのプロジェクトルールズとノートの管理
- ルールとノートのテンプレート（編集用マークダウン）の管理
- ルールとノートの階層構造の管理

#### 配置機能

- プロジェクトルートへの自動配置
- 固定された配置先への配置
- 既存ファイルとの競合回避

#### 編集管理

- 編集用マークダウンファイルの別ディレクトリ管理
- 編集内容の検証
- 編集済みファイルの適切な位置への配置

## 2. 技術要件

### 2.1 開発環境

- 言語: Python
- バージョン管理: GitHub
- パッケージ管理: Homebrew

### 2.2 依存関係

- マークダウンパーサー
- ファイルシステム操作ライブラリ
- 設定ファイル管理ライブラリ

### 2.3 利用環境

- Cursor エディタのターミナル上での利用を想定

## 3. ユーザーインターフェース

### 3.1 コマンドライン

```
crules init [<template-dir>]    # テンプレートからプロジェクトルールとノートを配置
crules deploy [<template-dir>]  # 編集済みファイルの配置
crules list [<template-dir>]    # 利用可能なルールの一覧表示
```

- `<template-dir>`: テンプレートディレクトリ名（例: `flutter`、`rails`）

## 4. 制約条件

- プロジェクトルートでの実行を前提
- 既存ファイルの上書きは確認必須
- 編集用ファイルは別ディレクトリで管理

## 5. プロジェクト構造

### 5.1 ディレクトリ構造

```
crules/
  ├── template/      # テンプレートディレクトリ（プロジェクトルート直下）
  │   ├── app/       # アプリケーション開発用
  │   │   ├── rules/ # プロジェクトルール
  │   │   └── notes/ # プロジェクトノート
  │   └── flutter/   # Flutter開発用
  │       ├── rules/ # プロジェクトルール
  │       └── notes/ # プロジェクトノート
  ├── crules/        # ソースコード
  │   ├── cli.py     # コマンドラインインターフェース
  │   ├── commands.py # コマンド実装
  │   ├── utils.py   # ユーティリティ関数
  │   └── __init__.py # パッケージ初期化
  ├── setup.py       # パッケージ設定
  ├── requirements.txt # 依存関係
  └── README.md      # プロジェクト説明
```

### 5.2 ファイル配置

- プロジェクトルール: `/.cursor/rules/` 以下に配置
- プロジェクトノート: `/.notes/` 以下に配置
- 編集用ファイル: `/template/` 以下に配置

### 5.3 ファイル形式

- プロジェクトルール: `.mdc` 拡張子（YAML マター付き）
  ```
  ---
  description: "このルールの概要を記述します"
  globs: src/**/*.ts, src/**/*.tsx
  alwaysApply: false
  ---
  ```
- プロジェクトノート: `.md` 拡張子（YAML マター付き）
  ```
  ---
  description: "このノートの概要を記述します"
  globs: src/**/*.ts, src/**/*.tsx
  alwaysApply: false
  ---
  ```
- 編集用ファイル: `.md` 拡張子（YAML マター付き）
- その他のファイル: 配置先と同じ拡張子

## 6. 機能詳細

### 6.1 ルールとノートの関係

- ルールとノートは別物として管理
- ルールは階層構造を持つ
- ルールファイルは 1 ファイル 30 行程度に制限
- ノートは Cursor エディタで直接編集・作成可能
- ノートも階層構造を持つことができる

### 6.2 編集管理

- 編集用ファイルは `/template` ディレクトリ以下に配置
- プロジェクトルールは直接編集できません。テンプレートディレクトリのファイルを編集し、適切な位置に配置してください。
- ノートは編集可能で、開発中に更新されます。`deploy`コマンドでは配置されません。

### 6.3 テンプレートディレクトリの役割

- テンプレートディレクトリはプロジェクトルート直下の`/template`に配置されます
- 各テンプレートディレクトリ（例：`app`、`flutter`）には、プロジェクトタイプごとのルールとノートのテンプレートが含まれます
- `init`コマンドは、指定されたテンプレートディレクトリからプロジェクトルールとノートを適切な位置に配置します
- `deploy`コマンドは、編集済みのテンプレートファイルを適切な位置に配置します
- `list`コマンドは、指定されたテンプレートディレクトリ内の利用可能なルールを一覧表示します

## 7. 今後の検討事項

1. ルールの検証機能
2. ルールのバージョン管理

## 8. 質問事項

1. 編集用ファイルの保存場所は固定ですか、それとも設定可能ですか？
2. チーム開発を想定していますか？その場合、どのような機能が必要ですか？
